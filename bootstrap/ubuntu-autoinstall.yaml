# cloud-config
autoinstall:
  version: 1
  locale: en_US.UTF-8
  timezone: America/Vancouver
  refresh-installer:
    update: true
  identity:
    hostname: template
    username: ansible
    password: '$y$j9T$5CvjbPtZh6.nAFZSNiFlD/$k.Tsz3ejl4/wmlVCP/991taRWg.BURZmTyerCbSJTI.' # hash of "ansible" by mkpasswd
  user-data:
    users:
      - name: ansible
        uid: 999
        # ODOT figure out how to get this set automatically
        # yamllint disable-line rule:line-length
        ssh_authorized_keys: ['ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGZduwQehr95DRVVxEzOu9tn2yoJDdugmzj6elCmE5uo cloud-config']
        groups: sudo, adm
        sudo: ['ALL=(ALL) NOPASSWD:ALL']
        shell: /bin/bash
  updates: all
  keyboard:
    layout: us
  storage:
    layout:
      name: lvm
      sizing-policy: all
  source:
    search-drivers: true
    id: ubuntu-server
  codecs:
    install: true
  drivers:
    install: true
  oem:
    install: false
  apt:
    mirror-selection:
      primary:
        - uri: 'http://mirror.it.ubc.ca/ubuntu'
        - country-mirror
        - uri: 'http://archive.ubuntu.com/ubuntu'
    fallback: abort
    geoip: true
  packages:
    - qemu-guest-agent
  ssh:
    install-server: true
    allow-pw: false
  shutdown: reboot
